<h1>Parcial - tema2</h1>
<p>Nota: 9.61 / 10.0 (APROBADO)</p>
<pre><code>puntaje ej1: 2
puntaje ej2: 2
puntaje ej3: 2
puntaje ej4: 2.62
puntaje ej5: 1
</code></pre>
<h2>Datos del alumno</h2>
<p>Nombre: Ezequiel Remus</p>
<p>DNI: 35019882</p>
<p>LU: 557/13</p>
<p>Maquina: 31-03</p>
<h2>Enunciado</h2>
<!doctype html>
<html>
<head>
  <link rel="icon" href="data:,">
  <link href="css/style.css" rel="stylesheet" />
  <meta charset="UTF-8">
  <style>
    th, td {
        border: 1px solid black;
        padding: 10px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
    }
    .conditions {
        margin-left: 20px;
    }
</style>
</head>

<body style="width: 70%;margin: 1% auto;">

<div>

<h1> Recuperatorio Haskell - Tema 2 </h1>

<h2> Importante </h2>

<ul>
  <li>El parcial se aprueba con 6 puntos</li>
  <li>Template de funciones a implementar <a href="#" onclick="forceDownload('/parcial/Template_t2.hs','Template_t2.hs');">acá</a><br></li>
  <li>Lista de funciones permitidas <a href="/static/haskell_permitidas.html">acá</a></li>
  <li>Para testear el código pueden usar <a href="#" onclick="forceDownload('/parcial/Test_template_t2.hs', 'Test_template_t2.hs')">este</a> archivo que ya cuenta con todo lo necesario para desarrollar sus propios tests (este archivo no se entrega)</li>
</ul>

Implementar las siguientes especificaciones en Haskell.

<form name="form1" action="/submit_examen" method="post" enctype="multipart/form-data" onsubmit="return validaciones(event)">

<h2> Enunciado </h2>


<hr style="width: 100%;">
  <h3 style="color:#1A5276">1) Ejercicio 1 [2 puntos]</h3>
<p>problema maximoActual (<i>lista</i>: seq⟨Z⟩) : seq⟨Z⟩ {<br>
  &nbsp; <strong>requiere:</strong> {|lista| > 0} <br>
  &nbsp; <strong>asegura:</strong> {|<i>res</i>|= |<i>lista</i>|} <br>
  &nbsp; <strong>asegura:</strong> {Cada uno de los elementos de <i>res</i> se obtienen como el maximo entre los elementos de <i>lista</i> para la misma posición y las anteriores.} <br>
}<br>
<b>Ejemplo:</b> dada la lista [1,3,2,5,1] debe devolver [1,3,3,5,5]
</p>

<hr style="width: 100%;">
<h3 style="color:#1A5276">2) Ejercicio 2 [2 puntos]</h3>
  <p>problema primosRepetidos (<i>n</i>: Z) : Z {<br>
    &nbsp; <strong>requiere:</strong> {n > 0} <br>
    &nbsp; <strong>asegura:</strong> {(<i>res</i> es la cantidad de factores primos que se repiten en la factorización.} <br>
    }<br>
    <b>Ejemplo:</b> El número 36, cuya descomposición en primos es 2 x 2 x 3 x 3, tiene repetidos 2 y 3 entre su descomposición, luego la función debe devolver 2.

  </p>

  <hr style="width: 100%;">
  <h3 style="color:#1A5276">3) Ejercicio 3 [2 puntos]</h3>
  <p>problema palabraCapicua (<i>palabra</i>: seq⟨Char⟩) : Bool {<br>
    &nbsp; <strong>requiere:</strong> {<i>palabra</i> es una secuencia de caracteres sin blancos y no vacia} <br>
    &nbsp; <strong>asegura:</strong> {(<i>res</i> = true <=> la <i>palabra</i> se puede leer de igual modo de adelante para atrás que de atrás para adelante.} <br>
    }<br>
    <b>Por ejemplo:</b> la palabra "anana".

  </p>

  <hr style="width: 100%;">
  <h3 style="color:#1A5276">4) Ejercicio 4 [3 puntos]</h3>
  <p>problema  cuantosDistintos (<i>palabra1</i>: seq⟨Char⟩, <i>palabra2</i>: seq⟨Char⟩) : Z⟩{<br>
    &nbsp; <strong>requiere:</strong> {|<i>palabra1</i>| > 0 y |<i>palabra2</i>| > 0}<br>
    &nbsp; <strong>asegura:</strong> {<i>res</i> es igual a la cantidad de caracteres en que <i>palabra1</i> y <i>palabra2</i> difieren sin contar repetidos.} <br>
  }<br>
<b>Ejemplo:</b> las palabras "casa" y "materias" difieren en las letras c, m, t, e, r y i, la función debe devolver 6.
  </p>

  <hr style="width: 100%;">
  <h3 style="color:#1A5276">5)Ejercicio 5 (1 punto)</h3>
  <p>
    Conteste marcando la opción correcta. En el contexto de la programación, definimos un tipo de datos como: <br>

  <input type="radio" name="mchoice_1" id="opcion1" value="1" />
      <label for="opcion1">Un conjunto de valores.</label> <br>
  <input type="radio" name="mchoice_1" id="opcion2" value="2" />
      <label for="opcion2">Un conjunto de valores y un conjunto de operaciones.</label> <br>
  <input type="radio" name="mchoice_1" id="opcion3" value="3" />
      <label for="opcion3">Un conjunto de valores y un conjunto de variables.</label> <br>
  </p>

</ol>

<hr>
  <h3 style="color:#1A5276">Adjunta el archivo con tu solución:</h3>
  <p><b style="color:red">Solo se puede adjuntar 1 archivo de extensión .hs. En caso de haber desarrollado tests propios, no deben ser entregados.</b></p>

  <label for="archivo">Seleccionar archivo a enviar:</label>
  <input type="file" id="archivo" name="archivo" required accept=".hs,text/x-haskell"/>

  <input type="submit" value="Enviar"
        style= "background-color: #1A5276; border-radius: 5px;
                margin-top:10px;padding: 10px 150px;color: #FFFFFF;
                font-size: 20px;cursor: pointer; width:100%" >

</form>

</div>

<script>
  function validaciones(event) {
    // Obtiene todos los inputs tipo radio del formulario
    const radioGroups = document.querySelectorAll('input[type="radio"]');
      const groupedByName = {};

      // Agrupar radios por su atributo name
      radioGroups.forEach(radio => {
        if (!groupedByName[radio.name]) {
          groupedByName[radio.name] = [];
        }
        groupedByName[radio.name].push(radio);
      });

      // Verificar que cada grupo de radios tenga al menos uno seleccionado
      for (const groupName in groupedByName) {
        const radios = groupedByName[groupName];
        const isChecked = radios.some(radio => radio.checked);

        if (!isChecked) {
          alert(`Debes seleccionar una opción para la pregunta ${groupName}`);
          return false; // Detener la validación si falta alguna opción
        }
      }

      var confirmacion = confirm("Confirmo que revisé mis respuestas y que quiero entregar mi examen");
      if (!confirmacion) {
        event.preventDefault();
        event.returnValue = false;
        return false;
      }
      event.returnValue = true;
      return true;
  }

// registro una funcion para mostrar el archivo cuando se adjunta.
// de esa forma evitamos que se adjunten otros archivos por error
document
  .getElementById('archivo')
  .addEventListener(
      'change',
      function () {
          var fr = new FileReader();
          fr.onload = function () {
              alert(this.result);
          };
          fr.readAsText(this.files[0]);
      }
  );

// para forzar a bajar el template de hunit y que no se pueda abrir en un nuevo tab
// (el browser intenta mostrar el codigo como HTML y el formato se ve raro)
function forceDownload(url, filename) {
  fetch(url).then(function(t) {
    return t.blob().then((b) => {
      var a = document.createElement("a");
      a.href = URL.createObjectURL(b);
      a.setAttribute("download", filename);
      a.click();
    });
  });
}
</script>

</body>

</html>

<h2>Solucion entregada por el alumno</h2>
<pre><code>module SolucionT1 where

{--
    Alumno: Ezequiel Remus
--}


-- Ejercicio 1
{--
problema maximoActual (lista: seq⟨Z⟩) : seq⟨Z⟩ {
  requiere: {|lista| &gt; 0}
  asegura: {|res|= |lista|}
  asegura: {Cada uno de los elementos de res se obtienen 
  como el maximo entre los elementos de lista para la misma posición y las anteriores.}
}

Ejemplo: dada la lista [1,3,2,5,1] debe devolver [1,3,3,5,5] 
--}

maximoActual:: [Integer] -&gt; [Integer]
maximoActual [x] = [x]
maximoActual (x:y:xs) 
    | x&gt;y = x:(maximoActual (x:xs))
    | otherwise = x:(maximoActual (y:xs))


-- Ejercicio 2
{--
2) Ejercicio 2 [2 puntos]

problema primosRepetidos (n: Z) : Z {
  requiere: {n &gt; 0}
  asegura: {
    (res es la cantidad de factores primos 
     que se repiten en la factorización.}
}
Ejemplo: El número 36, cuya descomposición en primos es 2 x 2 x 3 x 3, 
tiene repetidos 2 y 3 entre su descomposición, luego la función debe devolver 2. 
--}
-- cantidadDivisores :: Integer -&gt; Integer -&gt; Integer




factorizar :: Integer -&gt; Integer -&gt; [Integer]
factorizar 1 _ = []
factorizar m d 
    | mod m d == 0 = d:(factorizar (div m d) d)
    | otherwise = factorizar m (d+1)

contarApariciones :: Integer -&gt; [Integer] -&gt; Integer
contarApariciones _ [] = 0
contarApariciones n (x:xs)
    | n==x = 1 + contarApariciones n xs
    | otherwise = contarApariciones n xs

sacar :: Integer -&gt; [Integer] -&gt; [Integer]
sacar _ [] = [] 
sacar n (x:xs)
    | contarApariciones n (x:xs) &gt; 0 = sacar n xs
    | otherwise = x:sacar n xs

contarRepeticiones :: [Integer]  -&gt; Integer
contarRepeticiones [] = 0
contarRepeticiones [x] = 0 
contarRepeticiones (x:xs) 
    | contarApariciones x (x:xs) &gt;1 = 1 + contarRepeticiones (sacar x xs) 
    | otherwise = contarRepeticiones xs 

primosRepetidos :: Integer -&gt; Integer
primosRepetidos n = contarRepeticiones (factorizar n 2) 



-- Ejercicio 3
{--
problema palabraCapicua (palabra: seq⟨Char⟩) : Bool {
  requiere: {palabra es una secuencia de caracteres sin blancos y no vacia}
  asegura: {
    (res = true &lt;=&gt; la palabra se puede leer de igual modo de adelante
     para atrás que de atrás para adelante.
  }
}

Por ejemplo: la palabra &quot;anana&quot;. 
--}
reverso :: [Char] -&gt; String
reverso [] = &quot;&quot;
reverso (x:xs) = (reverso xs) ++ [x]

palabraCapicua :: String -&gt; Bool
palabraCapicua cadena = cadena == (reverso cadena)



-- Ejercicio 4
{--
problema cuantosDistintos (palabra1: seq⟨Char⟩, palabra2: seq⟨Char⟩) : Z⟩{
  requiere: {|palabra1| &gt; 0 y |palabra2| &gt; 0}
  asegura: {res es igual a la cantidad de caracteres en
   que palabra1 y palabra2 difieren sin contar repetidos.}
}

Ejemplo: las palabras &quot;casa&quot; y &quot;materias&quot; difieren en las letras c, m, t, e, r y i, la función debe devolver 6. 
--}
longitud :: (Eq t) =&gt; [t] -&gt;  Integer
longitud [] = 0
longitud (x:xs) = 1 + longitud xs

sacarIguales :: (Eq t)=&gt; t -&gt; [t] -&gt;  [t] 
sacarIguales t [] = []
sacarIguales t (x:xs) 
    | t == x = sacarIguales t xs
    | otherwise = x:(sacarIguales t xs)

sacarTodasLasIguales :: (Eq t)=&gt; [t] -&gt; [t] -&gt;  [t] 
sacarTodasLasIguales [] []  = []
sacarTodasLasIguales (x:xs) []   = []
sacarTodasLasIguales [] (y:ys)  = []
sacarTodasLasIguales [x] (y:ys) = sacarIguales x (y:ys)  
sacarTodasLasIguales (x:xs) (y:ys) = sacarTodasLasIguales xs (sacarIguales x (y:ys))

cuantosDistintos :: String -&gt; String -&gt; Integer
cuantosDistintos p1 p2 = longitud (sacarTodasLasIguales p1 p2) + longitud (sacarTodasLasIguales p2 p1)  
</code></pre>
<h2>Resultado de la compilacion</h2>
<pre><code>Loaded package environment from /home/ignacio/.ghc/x86_64-linux-9.4.7/environments/default
[1 of 1] Compiling SolucionT1       ( correcciones/haskell-recu-tn/remus_ezequiel_35019882/submission.hs.main.hs, correcciones/haskell-recu-tn/remus_ezequiel_35019882/submission.hs.main.o )

</code></pre>
<h2>Ejecucion de los tests</h2>
<h3>tema2-test-ej1.hs.compilacion.out</h3>
<p>Puntaje del ej: 2 / 2</p>
<pre><code>

Cases: 9  Tried: 1  Errors: 0  Failures: 0

Cases: 9  Tried: 2  Errors: 0  Failures: 0

Cases: 9  Tried: 3  Errors: 0  Failures: 0

Cases: 9  Tried: 4  Errors: 0  Failures: 0

Cases: 9  Tried: 5  Errors: 0  Failures: 0

Cases: 9  Tried: 6  Errors: 0  Failures: 0

Cases: 9  Tried: 7  Errors: 0  Failures: 0

Cases: 9  Tried: 8  Errors: 0  Failures: 0


Cases: 9  Tried: 9  Errors: 0  Failures: 0


Cases: 9  Tried: 9  Errors: 0  Failures: 0

</code></pre>
<h3>tema2-test-ej2.hs.compilacion.out</h3>
<p>Puntaje del ej: 2 / 2</p>
<pre><code>

Cases: 8  Tried: 1  Errors: 0  Failures: 0

Cases: 8  Tried: 2  Errors: 0  Failures: 0

Cases: 8  Tried: 3  Errors: 0  Failures: 0

Cases: 8  Tried: 4  Errors: 0  Failures: 0

Cases: 8  Tried: 5  Errors: 0  Failures: 0

Cases: 8  Tried: 6  Errors: 0  Failures: 0

Cases: 8  Tried: 7  Errors: 0  Failures: 0


Cases: 8  Tried: 8  Errors: 0  Failures: 0


Cases: 8  Tried: 8  Errors: 0  Failures: 0

</code></pre>
<h3>tema2-test-ej3.hs.compilacion.out</h3>
<p>Puntaje del ej: 2 / 2</p>
<pre><code>

Cases: 8  Tried: 1  Errors: 0  Failures: 0

Cases: 8  Tried: 2  Errors: 0  Failures: 0

Cases: 8  Tried: 3  Errors: 0  Failures: 0

Cases: 8  Tried: 4  Errors: 0  Failures: 0

Cases: 8  Tried: 5  Errors: 0  Failures: 0

Cases: 8  Tried: 6  Errors: 0  Failures: 0

Cases: 8  Tried: 7  Errors: 0  Failures: 0


Cases: 8  Tried: 8  Errors: 0  Failures: 0


Cases: 8  Tried: 8  Errors: 0  Failures: 0

</code></pre>
<h3>tema2-test-ej4.hs.compilacion.out</h3>
<p>Puntaje del ej: 2.62 / 3</p>
<pre><code>

Cases: 8  Tried: 1  Errors: 0  Failures: 0

Cases: 8  Tried: 2  Errors: 0  Failures: 0

Cases: 8  Tried: 3  Errors: 0  Failures: 0

Cases: 8  Tried: 4  Errors: 0  Failures: 0


### Failure in: 4
Tema2-test-ej4.hs:21
expected: 13
 but got: 11


Cases: 8  Tried: 5  Errors: 0  Failures: 1

Cases: 8  Tried: 6  Errors: 0  Failures: 1

Cases: 8  Tried: 7  Errors: 0  Failures: 1


Cases: 8  Tried: 8  Errors: 0  Failures: 1


Cases: 8  Tried: 8  Errors: 0  Failures: 1

</code></pre>
<h3>mchoice.json-ej5.compilacion.out</h3>
<p>Puntaje del ej: 1 / 1</p>
<pre><code>mchoice ej5: respuesta del alumno=2, respuesta correcta=2

Ran 1 test in 0 seconds

OK

</code></pre>
<p>FIN</p>